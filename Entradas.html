<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registros antes y después de las 8:00 AM</title>
        <!-- CSS de DataTables -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    
    <!-- jQuery -->
    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- DataTables JS -->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    
    <!-- <style>
        /* Estilo para las tablas */
     

        th,
        td {
            padding: 5px;
            border: 1px solid #ddd;
            text-align: left;
        }

   
    table {
        max-width: 65%;
        border-spacing: 0;
        border-collapse: collapse;
        overflow-x: auto;
    }

    table td {
        font-size: 12px;
    }
</style>-->

</head>

<body>

    <div style="display: flex; justify-content: space-around;">
        <div id="t1">

        </div>

        <div id="t2">

        </div>
    </div>


    <script>

        $(document).ready(function () {
            // Función para realizar la consulta y mostrar los resultados en una tabla
            function mostrarRegistros(tipo) {
                $.ajax({
                    url: 'router.php', // Ajusta la ruta a tu archivo PHP
                    method: 'POST',
                    data: {
                        accion: 'obtenerRegistros' + tipo,
                        controlador: 'Empleados',
                        fecha: obtenerFechaActual()
                    },
                    success: function (response) {
                        var datos = JSON.parse(response);
                        console.log('Datos recibidos:', datos);

                        if (tipo == "AntesDe8AM") {
                            construirTabla(datos,  $('#t1'), "AntesDe8AM");
                        } else if (tipo == "DespuesDe8AM") {
                            construirTabla(datos, $('#t2'), "DespuesDe8AM");
                        }
                    },
                    error: function (error) {
                        console.error(error);
                    }
                });
            }

            // Función para obtener la fecha actual en formato 'YYYY-MM-DD'
            function obtenerFechaActual() {
                var today = new Date();
                var dd = String(today.getDate()).padStart(2, '0');
                var mm = String(today.getMonth() + 1).padStart(2, '0'); // Enero es 0!
                var yyyy = today.getFullYear();
                return yyyy + '-' + mm + '-' + dd;
            }

            // Función para construir una tabla y agregarla al contenedor especificado
            
            function construirTabla(datos, contenedor, tipo) {
                var tabla = $('<table>').addClass('table table-bordered table-hover').appendTo(contenedor);
            
                // Añade encabezados a la tabla
                var thead = $('<thead>').addClass('table-primary').appendTo(tabla);
                var headerRow = $('<tr>').appendTo(thead);
            
                // Lista de columnas que quieres mostrar
                var columnasMostradas = ['Identificacion', 'Nombre', 'Cargo', 'Tipo de acceso', 'Estado', 'Hora de ingreso'];
            
                // Añade encabezados a la tabla solo para las columnas mostradas
                columnasMostradas.forEach(function (columna) {
                    $('<th>').text(columna).appendTo(headerRow);
                });
            
                // Añade filas de datos a la tabla
                var tbody = $('<tbody>').appendTo(tabla);
                datos.forEach(function (row) {
                    // Añade celdas solo para las columnas mostradas
                    var dataRow = $('<tr>').appendTo(tbody);
                    columnasMostradas.forEach(function (columna) {
                        $('<td>').text(row[columna]).appendTo(dataRow);
                    });
                });
            
                // Destruir DataTables si ya se ha inicializado
                if ($.fn.DataTable.isDataTable(tabla)) {
                    tabla.DataTable().destroy();
                }
                
                // Inicializar DataTables
                tabla.DataTable({
                    paging: true,
                    searching: true,
                });

            
                // Asigna colores específicos a las filas según el tipo de tabla
                /*var filas = tbody.find('tr');
                filas.each(function (index) {
                    if (tipo === 'AntesDe8AM') {
                        $(this).css('background-color', (index % 2 === 0) ? 'green' : 'green');
                        $(this).css('color', (index % 2 === 0) ? 'white' : 'white');
                    } else if (tipo === 'DespuesDe8AM') {
                        $(this).css('background-color', (index % 2 === 0) ? 'red' : 'red');
                        $(this).css('color', (index % 2 === 0) ? 'white' : 'white');
                    }
                });
            
                contenedor.css('overflow-x', 'auto');
                contenedor.css('text-align', 'center');
                tabla.css('margin', 'auto');*/
            }



            function tablaTemprano(datos) {

                var tabla = $('#contenedorTablaAntesDe8AM');

                for (var i = 0; i < datos.length; i++) {
                    var fila = $('<tr>');

                    var celdaIdentificacion = $('<td>').text(datos[i].identificacion);
                    fila.append(celdaIdentificacion);
                    celdaIdentificacion.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaNombre = $('<td>').text(datos[i].nombre);
                    fila.append(celdaNombre);
                    celdaNombre.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaCargo = $('<td>').text(datos[i].cargo);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');
                    var celdaCargo = $('<td>').text(datos[i].access_type);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');
                    var celdaCargo = $('<td>').text(datos[i].status);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaCargo = $('<td>').text(datos[i].date_time);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    tabla.append(fila);
                }
            }

            function tablaTarde(datos) {

                var tabla = $('#contenedorTablaDespuesDe8AM');

                for (var i = 0; i < datos.length; i++) {
                    var fila = $('<tr>');

                    var celdaIdentificacion = $('<td>').text(datos[i].identificacion);
                    fila.append(celdaIdentificacion);
                    celdaIdentificacion.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaNombre = $('<td>').text(datos[i].nombre);
                    fila.append(celdaNombre);
                    celdaNombre.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaCargo = $('<td>').text(datos[i].cargo);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');
                    var celdaCargo = $('<td>').text(datos[i].access_type);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');
                    var celdaCargo = $('<td>').text(datos[i].status);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    var celdaCargo = $('<td>').text(datos[i].date_time);
                    fila.append(celdaCargo);
                    celdaCargo.css('text-shadow', '2px 2px 4px rgba(0, 0, 0, 0.2)');

                    tabla.append(fila);
                }
            }
            mostrarRegistros("AntesDe8AM");
            mostrarRegistros("DespuesDe8AM");
        });






    </script>

</body>

</html>
